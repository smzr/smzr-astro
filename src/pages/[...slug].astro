---
import { useStoryblokApi } from "@storyblok/astro";
import StoryblokComponent from "@storyblok/astro/StoryblokComponent.astro";
import Layout from "../layouts/Layout.astro";
import Page_404 from './404.astro';
const storyblok = useStoryblokApi();
const slug = Astro.params.slug === undefined ? "home" : Astro.params.slug
let content;
try {
  const { data } = await storyblok.get(`cdn/stories/${slug}`, {
    version: import.meta.env.DEV ? "draft" : "published",
  });
  content = data.story.content
} catch (error) {
	return Astro.redirect('/404')
}
---
<Layout title={content.title} description={content.description}>
	<StoryblokComponent blok={content} />
</Layout>